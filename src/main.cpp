#include <Arduino.h>

#include "Characteristics.h"

#include "sensors/Laser.h"
#include "sensors/Ultrasound.h"
#include "Movement.h"
#include "reflexes/Moving.h"

/**
 * Разобраться в классе Movement, лишние кейсы.
 */

void setup() {
  TCCR3B = TCCR3B & 0xe0 | 0x05;

  Moving MovingObject;
  Vision VisionObject;

  Laser LaserObject;
  LaserObject.init();

  for (;;) {
    MovingObject.main(LaserObject, VisionObject);
  }
}

/**
 *  _________
 * | (.) (.) |
 * |   ---   |
 * |_\\___//_|
 * 
 * Концепт робота.
 * 
 * Главные цели: 
 *  - Избегать столкновения.
 *  - Плавные повороты.
 *  - Плавное ускорение и торможение.
 * 
 * Второстепенные цели: 
 *  - Стремление двигаться вперед относительно начального положения.
 *  - Определять движущиеся объекты и избегать их.
 *  - Включать фары при низком освещении.
 *  - Включать стопари при торможении и заднем ходе.
 * 
 * Особенности:
 *  - Обычно движется не на максимальной скорости.
 *  - Иногда ускоряет скорость движение до максимальной.
 *  - Может разворачиваться на месте.
 *  - Поворачивает с нахлестом по дуге для определения достаточного места для проезда.
 *    Сила нахлеста зависит от его ширины.
 * 
 * Поведение:
 *  Избегает столкновение следующим способом:
 *    - Измеряет расстояние перед собой.
 *    - Обнаружив препятствие на определенном расстоянии снижает скорость в 
 *      зависимости от расстояния до препятствия, при критической дистанции останавливается.
 *    - Поворот осуществляет при обнаружении препятствия, чем оно ближе, тем более резкий разворот.
 *      Поворачивает до тех пор, пока не увидит свободный путь.
 */
